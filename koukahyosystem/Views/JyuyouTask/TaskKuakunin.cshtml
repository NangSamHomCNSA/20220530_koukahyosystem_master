
@*//*
    * 作成者　:  ルインマー
    * 日付：20200914
    * 機能　：重要タスク確定画面
    * 作成したパラメータ：Session["LoginName"]
    * 変更者：20220530　ナン　レスポンシブとJSの修正
    */*@

@model koukahyosystem.Models.JyuyoutaskModel
@{
    ViewBag.Title = "TaskKuakunin";
}

<!DOCTYPE html>
<html>
<head>
    <link href="~/Content/Common/commonstyle.css" rel="stylesheet" />
    <link href="~/lib/font-awesome/css/all.css" rel="stylesheet" />
    <meta name="viewport" content="width=device-width" />
    <style>

        #table1 th {
            background-color: rgb(189, 233, 242);
            border: 1pt solid black;
        }



        /*@@media all and (max-width:768px) {

            #table1 td {
                display: inline-block;

            }
        }*/

        .btncss {
            color: black;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            /*border: 0.5px solid #555555;*/
            border:none;
            border-radius: 4px;
        }


        /*.tab-content {
            height: 66vh;
            overflow: auto;
        }*/

        .scoll thead th {
            background-color: rgb(189, 233, 242);
            position: -webkit-sticky;
            position: sticky;
            top: 0;
            z-index: 2;
            border: 1pt solid black;
            background-clip: padding-box;
        }

        .t1 {
            border-radius: 5px;
            border-radius: 5px;
            padding: 2px;
            border-color: lightgray;
            border-style: inset;
            border-left-color: ghostwhite;
            border-top-color: ghostwhite;
        }

        .t2 {
            border-radius: 5px;
            border-radius: 5px;
            padding: 2px;
            border-color: lightgray;
            border-style: inset;
            border-left-color: ghostwhite;
            border-top-color: ghostwhite;
            /*min-width: 100px;*/
        }

        .t3 {
            border-radius: 5px;
            border-radius: 5px;
            padding: 2px;
            border-color: lightgray;
            border-style: inset;
            border-left-color: ghostwhite;
            border-top-color: ghostwhite;
        }

        .div_main {
            position: absolute;
            top: 50%;
            left: 50%;
            margin-top: -50px;
            margin-left: -50px;
            width: 100px;
            height: 100px;
            background-color: blue;
            box-shadow: 5px 5px 10px rgb(34, 148, 172);
        }

        .tasktemadrp {
            margin-left: 15px;
        }

        .taskmarkdrp {
            margin-left: 7px;
        }

        .taskbtndrp {
            margin-left: 20px;
        }

        .col1css {
            width: 430px;
            margin: 0px 20px 0px 0px !important;
        }

        .taskshinsei {
            margin-top: 50%;
        }
        .task_k_btn {
            margin:0px 0px 0px 60px;
            padding:0px 5px 0px 5px;
           
        }
        .task_k_shain {
            margin: 0px 0px 5px 20px !important;
        }
        .task_k_tema {
            margin-left:190px;
        }
    </style>
    <style>
        #table1 td {
            border: none;
        }

        #d2 {
            padding: 0px;
            width: 350px;
        }

        #d3 {
            padding-left: 0px;
            padding-right: 0px;
            margin-left: 205px;
        }

        #d4 {
            /*// padding-left: 15px;*/
            padding-left: 0px;
            padding-right: 0px;
            /*margin-left: 15px;*/
        }

        #d5 {
            float: right;
            margin-right: 10px;
            padding-left: 0px;
            padding-right: 0px;
        }

        #d6 {
            /*margin-top: -40px;*/
            margin-top: 0px;
            margin-right: 0px;
            padding-right: 0px;
        }

        #save_addrowbtn {
            float: right;
            margin-right: 0px;
            width: 170px;
            padding-left: 0px;
            padding-right: 0px;
        }
        .col1css {
            width: 430px;
            margin: 0px 20px 0px 0px !important;
        }
        .temadropdown {
            width: 450px;
            /*height: 40px;*/
            margin: 0px;
            max-width: 100%;
            Height: 30px; /*20220530 ナン　edited */
            background-color: #ECECEC; /*20220530 ナン　edited */
            text-align: left; /*20220530 ナン　edited */
        }

        /*20220530 ナン　edited */
        .shaindropdown {
            width: 150px;           
            margin: 0px;
            max-width: 100%;
            Height: 30px; 
            background-color: #ECECEC; 
            text-align: left; 
        }
        @@media only screen and (max-width: 1024px) {
            .task_k_tema {
                margin-left: 0px;
            }
            .task_k_btn {
                margin-left: 0px !important;
                padding: 0px 5px 0px 5px !important;
            }
        }
        @@media only screen and (max-width: 830px) {
            .task_k_tema {
                margin-left: 0px;
            }
        }

        @@media only screen and (max-width: 768px) {
            #table1 td {
                border: none;
            }

            #t1 {
                margin-left: 18px;
            }

            #save {
                padding-left: 0px;
                padding-right: 0px;
                margin-right: 0px;
                margin-left: 0px;
            }

            #b {
                padding-left: 0px;
                padding-right: 0px;
                margin-right: 0px;
                margin-left: 0px;
            }

            #d1 {
                padding-left: 0px;
                padding-right: 0px;
            }

            #d2 {
                padding-left: 0px;
                padding-right: 0px;
                margin-top: 10px;
            }

            #d3 {
                padding-left: 0px;
                padding-right: 0px;
                margin-left: 0px;
            }

            #d4 {
                padding-left: 0px;
                padding-right: 0px;
                margin-right: 0px;
                margin-left: 0px;
            }

            #d5 {
                float: left;
                padding-left: 0px;
                padding-right: 0px;
                margin-right: 0px;
                margin-left: 0px;
                margin-top: 20px;
            }

            #d6 {
                float: left;
                padding-left: 0px;
                padding-right: 0px;
                margin-right: 0px;
                margin-left: 0px;
                margin-top: 20px;
            }

            #save_addrowbtn {
                float: left;
                padding-left: 0px;
                padding-right: 0px;
                margin-right: 0px;
                margin-left: 0px;
            }

            .tasktemadrp {
                margin-left: 0px;
            }

            .taskmarkdrp {
                margin-left: 7px;
            }

            .taskbtndrp {
                margin-left: 0px;
            }

            .col1css {
                width: 340px;
                margin: 0px 10px 0px 0px !important;
            }

            .taskshinsei {
                margin-top: 0 !important;
            }
            .task_k_btn {
                margin: 0px 0px 0px 0px!important;
               
            }
            .task_k_shain {
                margin: 0px 0px 5px 20px!important;
              
            }
            .task_k_tema {
                margin-left: 0px;
            }
        }
        @@media only screen and (max-width: 420px) {
            .task_k_shain {
                margin: 0px 0px 5px 0px !important;
            }
        }
            @@media only screen and (max-width: 400px) {
                .col1css {
                    width: 280px;
                    margin: 0px 10px 0px 0px !important;
                }

                .task_k_btn {
                    margin: 0px 0px 0px 0px !important;
                }

              
            }

    </style>
</head>
<body class="fontsize">

    @if (TempData["com_msg"] != null)
    {
        <script type="text/javascript" src=@Url.Content("~/Scripts/jquery-1.12.4.min.js")></script>
        <script>
            $(document).ready(function(){

                @*alert('@TempData["com_msg"]');*@
            });
        </script>
    }
    @if (Session["isAuthenticated"] != null)
    {
        <div class="panel panel-info">
            @*style="overflow:auto"*@
            @using (Html.BeginForm("TaskKuakunin", "JyuyouTask", FormMethod.Post))
            {

                <div id="headertitle" style="background-color: rgb(34, 148, 172); width:100%;">
                    <h6 class="text-center align-middle headline" style="color:white;">目標を達成するための重要タスク</h6>
                </div>


                <div class="row" style="margin:10px 0px 0px 0px;">
                    <div class="col-auto" style="margin:0px 0px 5px 0px;">
                        @*  id="d1" *@
                        @Html.Label("年度", new { style = "color:black;font-weight: normal !important;margin-right:5px;" })
                        <button id="btnyesterday" name="btnyesterday" class="btn btn-link preBtn" value=@Model.selectyear>
                            <i class="fas fa-caret-left"></i>
                        </button>
                        @Html.DropDownListFor(m => m.selectyear, Model.yearList, new {

                       @id = "selectyear", style = "width:70px;",
                       @class = "btn btn-sm dropdown-toggle yeardropdown",
                       onchange = "return OnChangeddate()"
                   })
                        <button id="btntomorrow" name="btnnext" class="btn btn-link preBtn">
                            <i class="fas fa-caret-right"></i>
                        </button>
                    </div>
                    <div class="col-sm-8 col-md-5  col-lg-auto task_k_shain" id="d2">
                        @Html.Label("社員名", new { style = "color:black;font-weight: normal !important;" })
                        @if (Model.cShainList.Count() > 0)
                        {
                            @Html.DropDownListFor(m => m.cShain, Model.cShainList, new { @class = "shaindropdown btn btn-sm dropdown-toggle", @id = "cShain", @autofocus = true, style = "margin-left:10px;margin-bottom:4px;", onchange = "return OnChangedshainlist()" })
                        }
                        else
                        {
                            @Html.DropDownListFor(m => m.cShain, Model.cShainList, "", new { @class = "shaindropdown btn btn-sm dropdown-toggle", @id = "cShain", @autofocus = true, style = "margin-left:5px;", onchange = "return OnChangedshainlist()" })

                        }
                        @if (Session["checkGroupornot"].ToString() != "")
                        {
                            @Html.Label("部署全員", new { style = "color:black;font-weight: normal !important;margin-left:30px;" })
                            @Html.CheckBoxFor(m => m.isActive, new { @id = "check", style = "margin-left:5px;" })
                        }
                        else
                        {
                            @Html.Label("部署全員", new { style = "color:black;font-weight: normal !important;margin-left:30px;" })
                            @Html.CheckBox("isnotActive", false, new { style = "margin-left:5px;", @onclick = "return false" })
                        }

                    </div>


                </div>
                <div class="row">

                    <div class="col-auto mb-1 task_k_tema" style="width:528px;">
                        @*id="d3" *@
                        @Html.Label("テーマ", new { style = "color:black;font-weight: normal !important;margin-right:18px;" })

                        @if (Model.cTEMAList.Count() > 0)
                        {
                            @Html.DropDownListFor(m => m.cTEMA, Model.cTEMAList, new { @class = "temadropdown btn btn-sm dropdown-toggle", @id = "cTEMA", onchange = "return OnChanged()" })
                        }
                        else
                        {
                            @Html.DropDownListFor(m => m.cTEMA, Model.cTEMAList, "", new { @class = "temadropdown btn btn-sm dropdown-toggle", @id = "cTEMA", onchange = "return OnChanged()" })

                        }


                    </div>
                    <div class="col-sm-auto col-md-auto col-lg-auto mb-1">
                        @* id="d4" *@
                        @if (TempData["Haiten"] != null)
                        {
                            if (@Model.rdo_komoku == "2")
                            {
                                @Html.Label("点数 ", new { id = "status_haitem", style = "color:black;font-weight: normal !important;" })

                            }
                            else
                            {
                                @Html.Label("配点 ", new { id = "status_haitem", style = "color:black;font-weight: normal !important;" })
                            }
                            <label style="color:black;font-weight: normal !important;margin-left:10px;">@TempData["Haiten"].ToString()</label>
                            // @Html.Label(TempData["Haiten"].ToString(), new { id = "status_haitem1", style = "color:black;font-weight: normal !important;margin-left:10px;" })

                        }
                        @if (TempData["status"] != null)
                        {
                            @Html.Label("点数", new { id = "status_haitem2", style = "color:black;font-weight: normal !important;margin-left:10px;display:" + @Model.visible + ";" })
                            <label style="color:black;font-weight: normal !important;margin-left:5px;display:@Model.visible">@TempData["status"].ToString()</label>

                            // @Html.Label(TempData["status"].ToString(), new { id = "status_haitem3", style = "color:black;font-weight: normal !important;margin-left:10px;display:" + @Model.visible + ";" })
                        }
                    </div>


                    <div class="col-sm-auto col-md-auto col-lg-auto mb-1 ">
                        <div class="task_k_btn">
                            @if (Model.cTEMAList.Count() > 0)
                            {
                                if (@Model.kakunintemalist.Count > 0)
                                {

                                    if (@Session["allowkakunin"].ToString() == "2")
                                    {
                                        <button class="SaveBtn" type="submit" id="save" name="save" style="background-color:#9dccf1;cursor:not-allowed;opacity:0.6;text-align:center;w" tabindex="-1" disabled> 一時保存 </button>

                                    }
                                    else
                                    {
                                        <button class="SaveBtn" type="submit" id="save" name="save" style="background-color:#9dccf1;text-align:center;float:right;"> 一時保存 </button>
                                    }
                                }
                                else
                                {
                                    <button class="SaveBtn" type="submit" id="save" name="save" style="background-color:#9dccf1;cursor:not-allowed;opacity:0.6;text-align:center;" tabindex="-1" disabled> 一時保存 </button>

                                }
                            }
                            else
                            {
                                <button class="SaveBtn" type="button" id="b" name="b" style="background-color:#9dccf1;text-align:center; " onclick="savemsgshow()"> 一時保存 </button>
                            }
                        </div>

                    </div>




                </div>

                <div class="container" id="tabs" style="margin-top:10px;overflow:auto">
                    @*<div class="tab-content">*@
                    <table class="scoll" align="center" cellpadding="6" id="table1">
                        @*@Session["Fcount"].ToString() == "1" ||*@
                        @if (@Session["allowkakunin"].ToString() == "2")
                        {
                            <thead>
                                <tr>
                                    <th style="display:none;" class="sticky-col first-col"> </th>
                                    <th style="display:none;"></th>
                                    <th style="text-align: center;display:none;"></th>
                                    <th style="text-align: center;display:none;"></th>
                                    <th class="sticky-col second-col" style="display:none;">テーマ内容</th>
                                    <th style="display:none;">達成率(％)</th>
                                    <th style="display:none;">メモ</th>
                                    <th style="display:none;">メモ</th>

                                </tr>
                            </thead>
                            <tbody>
                                @for (int i = 0; i < Model.kakunintemalist.Count; i++)
                                {
                                    <tr>
                                        <td style="text-align: center;width:25px;vertical-align:top" tabindex="-1">
                                            @Model.kakunintemalist[i].No
                                        </td>
                                        <td style="display:none">
                                            @Html.TextBoxFor(model => model.kakunintemalist[i].Empid)
                                        </td>
                                        <td style="display:none">
                                            @Html.TextBoxFor(model => model.kakunintemalist[i].value1)
                                        </td>
                                        <td style="display:none">
                                            @Html.TextBoxFor(model => model.kakunintemalist[i].value2)
                                        </td>
                                        <td>
                                            @*style="width:430px;"*@
                                            <div class="row">
                                                <div id="task1" class="col-auto col1css" style=" display:inline-block;padding:0!important;">
                                                    @Html.Label("実施期間", new { @tabindex = "-1", style = "color:black;font-weight: normal !important;" })

                                                    <select id="row" style="width:90px;" tabindex="-1" disabled>
                                                        @for (int m = 0; m < Model.MonthList.Count; m++)
                                                        {
                                                            if (@Model.MonthListValue[m].selectmonthvalue == Model.kakunintemalist[i].StartMonth)
                                                            {
                                                                <option selected value=@Model.MonthListValue[m].selectmonthvalue>@Model.MonthList[m].selectmonth</option>
                                                            }
                                                            else
                                                            {
                                                                <option value=@Model.MonthListValue[m].selectmonthvalue>@Model.MonthList[m].selectmonth</option>
                                                            }
                                                        }
                                                    </select>

                                                    @Html.Label("~", new { @tabindex = "-1", style = "" })

                                                    <select id="row" style="width:90px;" tabindex="-1" disabled>
                                                        @for (int m = 0; m < Model.MonthList.Count; m++)
                                                        {
                                                            if (@Model.MonthListValue[m].selectmonthvalue == Model.kakunintemalist[i].EndMonth)
                                                            {
                                                                <option selected value=@Model.MonthListValue[m].selectmonthvalue>@Model.MonthList[m].selectmonth</option>
                                                            }
                                                            else
                                                            {
                                                                <option value=@Model.MonthListValue[m].selectmonthvalue>@Model.MonthList[m].selectmonth</option>
                                                            }
                                                        }
                                                    </select>
                                                    <button id="btnclear" name="btnclear" style="width:12px;height:12px;background-color:white;padding: 0;border: none;" tabindex="-1" disabled>
                                                        <img src="@Url.Content("~/Img/pic/cancel.jpg")" style="width:100%;margin-bottom:8px; " />
                                                    </button>


                                                    <input type="checkbox" id="c" name="c" value="c" onclick="return false" style="margin-left:10px;" tabindex="-1">

                                                    @Html.Label("年間", new { @tabindex = "-1", style = "color:black;font-weight: normal !important;margin-right:5px;" })


                                                    @Html.TextAreaFor(model => model.kakunintemalist[i].Name, 5, 60, new
                                               {
                                                   @class = "t1 mb-1",
                                                   maxlength = 500,
                                                   placeholder = "タスク内容",
                                                   rows = "5",
                                                   @readonly = "readonly",
                                                   @tabindex = "-1",
                                                   oninput = "if (this.value != '') this.style.borderColor= '';" +
                                                         "if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength)",

                                                   style = "background-color:whitesmoke;text -align: left; float: right;width:430px;max-width: 100%;margin-top:6px;"
                                               })
                                                </div>
                                                <div class="col-auto mb-1  " style="width:300px;display:inline-block;margin:0!important;padding:0!important;">
                                                    @Html.Label("配点", new { @tabindex = "-1", style = "color:black;font-weight: normal !important;margin-bottom:6px;display:" + @Model.visible + ";" })

                                                    @Html.TextBoxFor(model => model.kakunintemalist[i].nHaitem, new
                                               {
                                                   @class = " t1 fullwidth_halfwidth mb-1",
                                                   @readonly = "readonly",
                                                   @tabindex = "-1",
                                                   style = "background-color:whitesmoke;width:50px;text-align: right; margin-bottom:6px;display:" + @Model.visible + ";"
                                               })
                                                    @Html.Label("達成率", new { @tabindex = "-1", style = "color:black;font-weight: normal !important;margin-bottom:6px;margin-left:6px;" })

                                                    @Html.TextBoxFor(model => model.kakunintemalist[i].result, new
                                               {
                                                   @class = " t1 fullwidth_halfwidth",
                                                   @readonly = "readonly",
                                                   @tabindex = "-1",
                                                   oninput = "if (this.value != '') this.style.borderColor= '';(!validity.rangeOverflow||(value=100)) && (!validity.rangeUnderflow||(value=1)) &&(!validity.stepMismatch || (value = parseInt(this.value)));if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength)",
                                                   style = "background-color:whitesmoke;width:45px;text-align: right; margin-bottom:6px;"
                                               })
                                                    @Html.Label("点数", new { @tabindex = "-1", style = "color:black;font-weight: normal !important;margin-bottom:6px;margin-left:6px;display:" + @Model.visible + ";" })

                                                    @Html.TextBoxFor(model => model.kakunintemalist[i].nTensu, new
                                               {
                                                   @class = " t1",
                                                   @readonly = "readonly",
                                                   @tabindex = "-1",
                                                   style = "background-color:whitesmoke;width:55px;text-align: right; margin-bottom:6px;display:" + @Model.visible + ";"

                                               })
                                                    @Html.TextAreaFor(model => model.kakunintemalist[i].memo, new
                                               {
                                                   @class = "t3",
                                                   placeholder = "実施結果",
                                                   maxlength = 500,
                                                   rows = "5",
                                                   onkeydown = "if (event.keyCode == 13) { return false;}",
                                                   oninput = "if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength)",
                                                   @readonly = "readonly",
                                                   @tabindex = "-1",
                                                   style = "background-color:whitesmoke;text-align: left;width:300px;"
                                               })

                                                </div>
                                                <div class="col-auto mb-1 " style="display:inline-block;padding:0!important;margin:0!important;">
                                                    @if (Model.cTEMAList.Count() > 0)
                                                    {
                                                        if (@Model.kakunintemalist[i].value2 == "1" && @Model.kakunintemalist[i].value1 == "1")
                                                        {
                                                            var j = i + 1;
                                                            <button class="btncss" type="button" id="f" name="f" tabindex="-1" style="cursor:not-allowed;opacity:0.6;margin-right: 0px ;text-align:center;width:50px; height:30px;margin-top:36px;" value="済" disabled> 済</button>
                                                        }
                                                        else if (@Model.kakunintemalist[i].value2 == "1" && @Model.kakunintemalist[i].value1 == "0")
                                                        {
                                                            var j = i + 1;
                                                            <button class="btncss" type="button"  id="f" name="f" tabindex="-1" style="background-color:#FFCDFF;cursor:not-allowed;opacity:0.6;margin-right: 0px ;text-align:center;width:50px; height:30px;margin-top:36px;" value="確定" disabled> 確定</button>
                                                        }
                                                        else
                                                        {
                                                            var j = i + 1;
                                                            <button class="btncss" type="button" id=@j name=@j tabindex="-1" onclick="sayHello(id)" style="border-radius:4px;background-color:#FFCDFF;cursor:not-allowed;opacity:0.6;margin-right: 0px ;text-align:center;width:50px; height:30px;margin-top:36px;" value="確定" disabled>確定</button>

                                                        }

                                                    }
                                                    else
                                                    {
                                                        <button class="btncss"  type="button" id="b" name="b" tabindex="-1" style="background-color:#FFCDFF; margin-right: 0px ;text-align:center; width:50px; height:30px;margin-top:36px;" onclick="savemsgshow()" disabled>確定</button>

                                                    }
                                                </div>
                                            </div>




                                        </td>
                                        <td></td>  @*style="width:300px;"*@
                                        <td style="display:none">
                                            @Html.TextBoxFor(model => model.kakunintemalist[i].kakuninsha)
                                        </td>
                                        <td style="vertical-align:top;"></td>
                                    </tr>
                                }
                            </tbody>

                        }
                        else
                        {
                            <thead>
                                <tr>
                                    <th class="sticky-col first-col" style="display:none;"> </th>
                                    <th style="display:none;"></th>
                                    <th style="text-align: center;display:none;"></th>
                                    <th style="text-align: center;display:none;"></th>
                                    <th class="sticky-col second-col" style="display:none;">テーマ内容</th>
                                    <th style="display:none;">達成率(％)</th>
                                    <th style="display:none;">メモ</th>
                                    <th style="display:none;">メモ</th>

                                </tr>
                            </thead>
                            <tbody>

                                @for (int i = 0; i < Model.kakunintemalist.Count; i++)
                                {
                                    var clearbtnid = i + 1;
                                    var rowid = i + 1;
                                    <tr>
                                        <td style="text-align: center;width:40px;vertical-align:top;" tabindex="-1">
                                            @Model.kakunintemalist[i].No
                                        </td>
                                        <td style="display:none">
                                            @Html.TextBoxFor(model => model.kakunintemalist[i].Empid)
                                        </td>
                                        <td style="display:none">
                                            @Html.TextBoxFor(model => model.kakunintemalist[i].value1)
                                        </td>
                                        <td style="display:none">
                                            @Html.TextBoxFor(model => model.kakunintemalist[i].value2)
                                        </td>
                                        <td >
                                            <div class="row">
                                                <div id="task1" class="col-auto col1css" style=" display:inline-block;padding:0!important;">
                                                    @Html.Label("実施期間", new { @tabindex = "-1", style = "color:black;font-weight: normal !important;" })
                                                    <select id=@rowid style="width:90px;" onchange="return OnChangesdate(id)">
                                                        @for (int m = 0; m < Model.MonthList.Count; m++)
                                                        {
                                                            if (@Model.MonthListValue[m].selectmonthvalue == Model.kakunintemalist[i].StartMonth)
                                                            {
                                                                <option selected value=@Model.MonthListValue[m].selectmonthvalue>@Model.MonthList[m].selectmonth</option>
                                                            }
                                                            else
                                                            {
                                                                <option value=@Model.MonthListValue[m].selectmonthvalue>@Model.MonthList[m].selectmonth</option>
                                                            }
                                                        }
                                                    </select>

                                                    @Html.Label("~", new { @tabindex = "-1", style = "" })
                                                    <select id=@rowid style="width:90px;" onchange="return OnChangeedate(id)">
                                                        @for (int m = 0; m < Model.MonthList.Count; m++)
                                                        {
                                                            if (@Model.MonthListValue[m].selectmonthvalue == Model.kakunintemalist[i].EndMonth)
                                                            {
                                                                <option selected value=@Model.MonthListValue[m].selectmonthvalue>@Model.MonthList[m].selectmonth</option>
                                                            }
                                                            else
                                                            {
                                                                <option value=@Model.MonthListValue[m].selectmonthvalue>@Model.MonthList[m].selectmonth</option>
                                                            }
                                                        }
                                                    </select>
                                                    <button id=@clearbtnid name=@clearbtnid onclick="cleardate(id)" style="width:12px;height:12px;background-color:white;padding: 0;border: none;">
                                                        <img src="@Url.Content("~/Img/pic/cancel.jpg")" style="width:100% ;margin-bottom:8px;" />
                                                    </button>

                                                    <input type="checkbox" id=@clearbtnid name=@clearbtnid @*value=@clearbtnid*@ onclick="showreqdate(name)" style="margin-left:10px;">
                                                    @Html.Label("年間", new { @tabindex = "-1", style = "color:black;font-weight: normal !important;margin-right:5px;" })
                                                    @Html.TextAreaFor(model => model.kakunintemalist[i].Name, 5, 60, new
                                               {
                                                   @class = "t1 mb-1",
                                                   maxlength = 500,
                                                   placeholder = "タスク内容",
                                                   rows = "5",
                                                   oninput = "if (this.value != '') this.style.borderColor= '';" +
                                                 "if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength)",
                                                   type = "tel",
                                                   style = "ime-mode: inactive; text -align: left; float:left;width:430px;margin-top:6px; max-width:100%;"
                                               })
                                                    @Html.HiddenFor(model => model.kakunintemalist[i].StartMonth)
                                                    @Html.HiddenFor(model => model.kakunintemalist[i].EndMonth)
                                                </div>
                                                <div class="col-auto mb-1  " style="width:300px;display:inline-block;margin:0!important;padding:0!important;">
                                                    @Html.Label("配点", new { @tabindex = "-1", style = "color:black;font-weight: normal !important;margin-bottom:6px;display:" + @Model.visible + ";" })

                                                    @if (@TempData["Haiten"] != null)
                                                    {
                                                        @Html.TextBoxFor(model => model.kakunintemalist[i].nHaitem, new
                                                   {
                                                       @class = " t1 fullwidth_halfwidth",
                                                       //@type = "number",
                                                       @id = @clearbtnid,
                                                       maxlength = 4,

                                                       onkeypress = "isSpecialKey(event)",
                                                       oninput = "edValueKeyPress(id)",
                                                       // oninput = "if (this.value != '') this.style.borderColor= '';(!validity.rangeOverflow||(value=999)) && (!validity.rangeUnderflow||(value=1)) &&(!validity.stepMismatch || (value = parseInt(this.value)));if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength)",
                                                       style = "width:50px;text-align: right; margin-bottom:6px;display:" + @Model.visible + ";"
                                                   })
                                                    }
                                                    else
                                                    {
                                                        @Html.TextBoxFor(model => model.kakunintemalist[i].nHaitem, new
                                                   {
                                                       @class = " t1 fullwidth_halfwidth",
                                                       //@type = "number",
                                                       @id = @clearbtnid,
                                                       maxlength = 4,
                                                       @readonly = true,
                                                       @tabindex = "-1",
                                                       onkeypress = "isSpecialKey(event)",
                                                       oninput = "edValueKeyPress(id)",
                                                       // oninput = "if (this.value != '') this.style.borderColor= '';(!validity.rangeOverflow||(value=999)) && (!validity.rangeUnderflow||(value=1)) &&(!validity.stepMismatch || (value = parseInt(this.value)));if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength)",
                                                       style = "background-color:whitesmoke;width:50px;text-align: right; margin-bottom:6px;display:" + @Model.visible + ";"
                                                   })
                                                    }


                                                    @Html.Label("達成率", new { @tabindex = "-1", style = "color:black;font-weight: normal !important;margin-bottom:6px;margin-left:6px;" })

                                                    @Html.TextBoxFor(model => model.kakunintemalist[i].result, new
                                               {
                                                   @class = " t1 fullwidth_halfwidth",
                                                   @id = @clearbtnid,
                                                   // @type = "number",
                                                   //placeholder = "達成率(％)",
                                                   //@readonly = "readonly",
                                                   onkeyup = "edValueKeyPress(id)",
                                                   onkeypress = "isSpecialKey(event)",
                                                   maxlength = 4,
                                                   //oninput = "if (this.value != '') this.style.borderColor= '';if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength)",
                                                   oninput = "edValueKeyPress(id)",
                                                   style = "width:45px;text-align: right; margin-bottom:6px;"
                                               })

                                                    @Html.Label("点数", new { @tabindex = "-1", style = "color:black;font-weight: normal !important;margin-bottom:6px;margin-left:6px;display:" + @Model.visible + ";" })
                                                    @Html.TextBoxFor(model => model.kakunintemalist[i].nTensu, new
                                               {
                                                   @class = " t1 fullwidth_halfwidth",
                                                   //@type = "number",
                                                   // placeholder = "点数",
                                                   @readonly = "readonly",
                                                   @tabindex = "-1",
                                                   oninput = "if (this.value != '') this.style.borderColor= '';if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength)",
                                                   style = "background-color:whitesmoke;width:55px;text-align: right;margin-bottom:6px;display:" + @Model.visible + ";"
                                               })


                                                    @Html.TextAreaFor(model => model.kakunintemalist[i].memo, new
                                               {
                                                   @class = "t3",
                                                   placeholder = "実施結果",
                                                   maxlength = 500,
                                                   rows = "5",
                                                   oninput = "if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength)",
                                                   style = "text-align: left;width:300px;"
                                               })
                                                </div>
                                                <div class="col-auto mb-1 " style="display:inline-block;padding:0!important;margin:0!important;">
                                                    @if (Model.cTEMAList.Count() > 0)
                                                    {
                                                        if (@Model.kakunintemalist[i].value2 == "1" && @Model.kakunintemalist[i].value1 == "1")
                                                        {
                                                            var j = i + 1;
                                                            <button class="btncss taskshinsei" type="button" id="f" name="f" tabindex="-1" style="cursor:not-allowed;opacity:0.6;margin-right: 0px ;text-align:center;width:50px; height:30px;margin-top:36px;" value="済" disabled> 済</button>
                                                        }
                                                        else if ((@Model.kakunintemalist[i].value2 == "1" && @Model.kakunintemalist[i].value1 == "0"))
                                                        {
                                                            var j = i + 1;
                                                            <button class="btncss taskshinsei" type="button" id="f" name="f" tabindex="-1" style="border-radius:4px;background-color:#FFCDFF;cursor:not-allowed;opacity:0.6;margin-right: 0px ;
                                                     text-align:center;width:50px; height:30px;margin-top:36px;" value="確定" disabled>
                                                                確定
                                                            </button>
                                                        }
                                                        else
                                                        {
                                                            var j = i + 1;
                                                            <button class="btncss taskshinsei" type="button" id=@j name=@j onclick="sayHello(id)" style="background-color:#FFCDFF;margin-right: 0px ;
                                                        text-align:center;width:50px; height:30px;margin-top:36px;" value="確定">
                                                                確定
                                                            </button>

                                                        }

                                                    }
                                                    else
                                                    {
                                                        <button class="btncss" type="button" id="b" name="b" style="background-color:#FFCDFF; margin-right: 0px ;text-align:center; width:50px; height:30px;margin-top:36px;" onclick="savemsgshow()">確定</button>

                                                    }
                                                </div>
                                            </div>
                                            
                                        </td>
                                        <td>
                                            @* style="width:300px;" *@




                                        </td>
                                        <td style="display:none">
                                            @Html.TextBoxFor(model => model.kakunintemalist[i].kakuninsha)
                                        </td>
                                        <td style="vertical-align:top;">
                                            

                                        </td>
                                    </tr>
                                }

                            </tbody>
                        }

                    </table>
                    <button type='submit' id="fsave" name="fsave" style="margin-right: 0px ;text-align:center;width:50px; height:30px;visibility:hidden;" value="確定"> 確定</button>

                    @*</div>*@
                </div>
                <button id="btnsearch" name="btnsearch" value="add" style="position: absolute; visibility:hidden">add</button>
                <button id="btnshainsearch" name="btnshainsearch" value="add" style="position: absolute; visibility:hidden">add</button>
                <button id="btntoday" name="btntoday" style="width:29px;height:29px;visibility:hidden">add</button>
                <button id="btnchecksearch" name="btnchecksearch" style="width:29px;height:29px;visibility:hidden">add</button>

                <input type="hidden" id="rowindex" name="rowindex" value="" />
                <input type="hidden" id="upper" name="upper" value=@Model.upper_value>
                <input type="hidden" id="lower" name="lower" value=@Model.lower_value>
            }

            <input type="hidden" id="txt_msg" name="txt_msg" value=@Session["kubun"].ToString() />
            <input type="hidden" id="txt_kisyu" name="txt_kisyu" value=@Model.kisyu_month />
            @if (Model.cTEMAList.Count() > 0)
            {
                <input type="hidden" id="txt_haitem" name="txt_haitem" value=@TempData["Haiten"] />

            }
        </div>


    }
    <script src="@Url.Content("~/Scripts/jquery-1.12.4.min.js")"></script>

    <script>

        function sayHello(id) {

            var oTable = document.getElementById("table1"); //20220530 nan added
            var rowLength = oTable.rows.length;             //20220530 nan added
            var oCells = oTable.rows.item(id).cells;        //20220530 nan added

            var msg = document.getElementById('txt_msg').value;
            //var leader_kubun = document.getElementById('leader_kubun').value;
            //var btntxt = document.getElementById('table1').rows[id].cells[7].children[0].value; //20220530 nan deleted
            var btntxt = oCells.item(4).children[0].children[2].children[0].value;   //20220530 nan Modify


            document.getElementById('rowindex').value = id;

            var hyokavalue = document.getElementById('table1').rows[id].cells[2].children[0].value;
            var kakuteivalue = document.getElementById('table1').rows[id].cells[3].children[0].value;

            //var sdate = document.getElementById('table1').rows[id].cells[4].children[1].value;
            //var edate = document.getElementById('table1').rows[id].cells[4].children[3].value;
            //var x = document.getElementById('table1').rows[id].cells[4].children[7].value;
            //var haitem = document.getElementById('table1').rows[id].cells[5].children[1].value;
            //var percent = document.getElementById('table1').rows[id].cells[5].children[3].value;
            //var x2 = document.getElementById('table1').rows[id].cells[6].children[0].value;
            var sdate = oCells.item(4).children[0].children[0].children[1].value; //開始期間 20220530　ナン edited
            var edate = oCells.item(4).children[0].children[0].children[3].value; //完了期間 20220530　ナン edited
            var x = oCells.item(4).children[0].children[0].children[7].value;     //タスク内容 20220530　ナン edited

            var haitem = oCells.item(4).children[0].children[1].children[1].value; //配点数 20220530　ナン edited
            var percent = oCells.item(4).children[0].children[1].children[3].value;//達成率数 20220530　ナン edited
            var x2 = oCells.item(4).children[0].children[1].children[6].value;　   //実地結果 20220530　ナン edited


            var notallow;
            var j = 0;
            var check = 0;
            var rowcount = 0;
            var checkvalue = 0;
            if (@Model.rdo_komoku== "1") {
                if (sdate.trim().length == 0 && edate.trim().length == 0 && x.trim().length == 0 && haitem.trim().length == 0 && percent.trim().length == 0 && x2.trim().length == 0) {
                    notallow = "no";
                }
            }
            else {
                if (sdate.trim().length == 0 && edate.trim().length == 0 && x.trim().length == 0 && percent.trim().length == 0) {
                    notallow = "no";
                }
            }

            if (x.trim().length == 0) {
                checkvalue++;
            }
            if (@Model.rdo_komoku== "1") {
                if (haitem.trim().length == 0) {
                    checkvalue++;
                }
            }
            if (hyokavalue == "1" && kakuteivalue == "0") {
                if (percent != "0%" && percent.trim().length > 0) {
                    notallow = "yes";
                }
                else {
                    notallow = "percent0";
                    check++;
                }
            }
            else {
                notallow = "yes";
            }
            if (checkvalue >= 1) {
                notallow = "no";
            }

            if (notallow == "percent0") {

                    if (@Model.rdo_komoku== "1") {
                        var comparehaiten = document.getElementById('txt_haitem').value;
                        var n1 = document.getElementById("table1").rows.length;
                        var totaltensu = 0;
                        for (var i = 1; i < n1; i++) {
                            //var haitem = document.getElementById('table1').rows[i].cells[5].children[1].value; 20220530 nan deleted
                            var haitem = oCells.item(4).children[0].children[1].children[1].value; //20220530 nan added
                            if (haitem.trim().length > 0) {
                                totaltensu += parseInt(haitem);
                            }

                        }
                        if (id == 12) {
                            if (comparehaiten == totaltensu) {

                                if (confirm("達成率が(「０」or 「」)になっても、確定してよろしいでしょうか？")) {
                                    $('#fsave').click();
                                }
                                else {
                                    //alert(i)
                                    event.preventDefault();
                                    //var sdate = document.getElementById('table1').rows[id].cells[4].children[1].value;
                                    //var edate = document.getElementById('table1').rows[id].cells[4].children[3].value;
                                    //var x = document.getElementById('table1').rows[id].cells[4].children[5].value;
                                    //var haitem = document.getElementById('table1').rows[id].cells[5].children[1].value;
                                    //var percent = document.getElementById('table1').rows[id].cells[5].children[3].value;

                                    var sdate = oCells.item(4).children[0].children[0].children[1].value; //開始期間 20220530　ナン edited
                                    var edate = oCells.item(4).children[0].children[0].children[3].value; //完了期間 20220530　ナン edited
                                    var x = oCells.item(4).children[0].children[0].children[5].value;     
                                    var haitem = oCells.item(4).children[0].children[1].children[1].value; //配点数 20220530　ナン edited
                                    var percent = oCells.item(4).children[0].children[1].children[3].value;//達成率数 20220530　ナン edited                                  

                                    if (percent == "0%") {
                                        //$(document.getElementById('table1').rows[id].cells[5].children[3]).css('borderColor', '#f3172d');
                                        $(oCells.item(4).children[0].children[1].children[3]).css('borderColor', '#f3172d');
                                    }
                                    if (percent.trim().length == 0) {
                                        //$(document.getElementById('table1').rows[id].cells[5].children[3]).css('borderColor', '#f3172d');
                                        $(oCells.item(4).children[0].children[1].children[3]).css('borderColor', '#f3172d');
                                    }
                                }
                            }
                            else {
                                alert("テーマ配点「" + comparehaiten + "」をオーバーしています。調整してください。")
                                event.preventDefault();

                            }
                        }
                        else {

                            if (totaltensu <= comparehaiten) {

                                if (confirm("達成率が(「０」or 「」)になっても、確定してよろしいでしょうか？")) {
                                    $('#fsave').click();
                                }
                                else {

                                    event.preventDefault();
                                    //var sdate = document.getElementById('table1').rows[id].cells[4].children[1].value;
                                    //var edate = document.getElementById('table1').rows[id].cells[4].children[3].value;
                                    //var x = document.getElementById('table1').rows[id].cells[4].children[7].value;
                                    //var haitem = document.getElementById('table1').rows[id].cells[5].children[1].value;
                                    //var percent = document.getElementById('table1').rows[id].cells[5].children[3].value;

                                    var sdate = oCells.item(4).children[0].children[0].children[1].value; //開始期間 20220530　ナン edited
                                    var edate = oCells.item(4).children[0].children[0].children[3].value; //完了期間 20220530　ナン edited
                                    var x = oCells.item(4).children[0].children[0].children[7].value;
                                    var haitem = oCells.item(4).children[0].children[1].children[1].value; //配点数 20220530　ナン edited
                                    var percent = oCells.item(4).children[0].children[1].children[3].value;//達成率数 20220530　ナン edited  


                                    if (percent.trim().length == 0) {
                                         //$(document.getElementById('table1').rows[id].cells[5].children[3]).css('borderColor', '#f3172d');
                                        $(oCells.item(4).children[0].children[1].children[3]).css('borderColor', '#f3172d');
                                    }
                                    if (percent == "0%") {
                                         //$(document.getElementById('table1').rows[id].cells[5].children[3]).css('borderColor', '#f3172d');
                                        $(oCells.item(4).children[0].children[1].children[3]).css('borderColor', '#f3172d');
                                    }

                                }
                            }
                            else {
                                alert("テーマ配点「" + comparehaiten + "」をオーバーしています。調整してください。")
                                event.preventDefault();
                            }

                        }
                    }
                    else {
                        if (id == 12) {

                            if (confirm("達成率が(「０」or 「」)になっても、確定してよろしいでしょうか？")) {
                                $('#fsave').click();
                            }
                            else {
                                //alert(i)
                                event.preventDefault();
                                //var percent = document.getElementById('table1').rows[id].cells[5].children[3].value; //20220530 nan deleted
                                var percent = oCells.item(4).children[0].children[1].children[3]; //20220530 nan added
                                if (percent == "0%") {
                                    //$(document.getElementById('table1').rows[id].cells[5].children[3]).css('borderColor', '#f3172d');//20220530 nan deleted
                                    $(oCells.item(4).children[0].children[1].children[3]).css('borderColor', '#f3172d'); //20220530 nan added
                                }
                                if (percent.trim().length == 0) {
                                    //(document.getElementById('table1').rows[id].cells[5].children[3]).css('borderColor', '#f3172d');//20220530 nan deleted
                                    $(oCells.item(4).children[0].children[1].children[3]).css('borderColor', '#f3172d'); //20220530 nan added
                                }
                            }

                        }
                        else {
                            if (confirm("達成率が(「０」or 「」)になっても、確定してよろしいでしょうか？")) {
                                $('#fsave').click();
                            }
                            else {

                                event.preventDefault();
                                //var percent = document.getElementById('table1').rows[id].cells[5].children[3].value; //20220530 nan deleted
                                var percent = oCells.item(4).children[0].children[1].children[3]; //20220530 nan added

                                if (percent.trim().length == 0) {
                                    //$(document.getElementById('table1').rows[id].cells[5].children[3]).css('borderColor', '#f3172d'); //20220530 nan deleted
                                    $(oCells.item(4).children[0].children[1].children[3]).css('borderColor', '#f3172d'); //20220530 nan added
                                }
                                if (percent == "0%") {
                                    //$(document.getElementById('table1').rows[id].cells[5].children[3]).css('borderColor', '#f3172d'); //20220530 nan deleted
                                    $(oCells.item(4).children[0].children[1].children[3]).css('borderColor', '#f3172d'); //20220530 nan added
                                }

                            }

                        }
                    }

            }

            else if (notallow == "no") {
                event.preventDefault();
                //var sdate = document.getElementById('table1').rows[id].cells[4].children[1].value;
                //var edate = document.getElementById('table1').rows[id].cells[4].children[3].value;
                //var x = document.getElementById('table1').rows[id].cells[4].children[7].value;
                //var haitem = document.getElementById('table1').rows[id].cells[5].children[1].value;
                //var percent = document.getElementById('table1').rows[id].cells[5].children[3].value;

                var sdate = oCells.item(4).children[0].children[0].children[1].value; //開始期間 20220530　ナン edited
                var edate = oCells.item(4).children[0].children[0].children[3].value; //完了期間 20220530　ナン edited
                var x = oCells.item(4).children[0].children[0].children[7].value;
                var haitem = oCells.item(4).children[0].children[1].children[1].value; //配点数 20220530　ナン edited
                var percent = oCells.item(4).children[0].children[1].children[3].value;//達成率数 20220530　ナン edited  

                if (x.trim().length == 0) {
                    //$(document.getElementById('table1').rows[id].cells[4].children[7]).css('borderColor', '#f3172d'); // 20220530 nan deleted
                    $(oCells.item(4).children[0].children[0].children[7]).css('borderColor', '#f3172d');
                }
                if (haitem.trim().length == 0) {
                   // $(document.getElementById('table1').rows[id].cells[5].children[1]).css('borderColor', '#f3172d'); // 20220530 nan deleted
                    $(oCells.item(4).children[0].children[1].children[1]).css('borderColor', '#f3172d');
                }
            }

            else {

                    if (@Model.rdo_komoku== "1") {
                        var comparehaiten = document.getElementById('txt_haitem').value;
                        var n1 = document.getElementById("table1").rows.length;
                        var totaltensu1 = 0.00;
                        var totaltensu = 0;
                        for (var i = 1; i < n1; i++) {
                            //var haitem = document.getElementById('table1').rows[i].cells[5].children[1].value; //20220530 nan deleted
                            var haitem =  oCells.item(4).children[0].children[1].children[1].value; // 20220530 nan added 
                            if (haitem.trim().length > 0) {

                                totaltensu += parseInt(haitem);
                            }

                        }

                        if (id == 12) {
                            if (comparehaiten == totaltensu) {
                                if (confirm("確定しますか？")) {
                                    $('#fsave').click();
                                }

                                else {
                                    event.preventDefault();
                                }


                            }
                            else {
                                alert("テーマ配点「" + comparehaiten + "」をオーバーしています。調整してください。")
                                event.preventDefault();

                            }
                        }
                        else {
                            if (totaltensu <= comparehaiten) {
                                if (confirm("確定しますか？")) {
                                    $('#fsave').click();
                                }

                                else {
                                    event.preventDefault();

                                }


                            }
                            else {
                                alert("テーマ配点「" + comparehaiten + "」をオーバーしています。調整してください。")
                                event.preventDefault();

                            }
                        }
                    }
                    else {
                        if (confirm("確定しますか？")) {
                            $('#fsave').click();
                        }

                        else {
                            event.preventDefault();
                        }
                    }

            }

        }
    </script>
    <script>
        function cleardate(id) {
            //document.getElementById('table1').rows[id].cells[4].children[1].value = "";
            //document.getElementById('table1').rows[id].cells[4].children[3].value = "";
            //document.getElementById('table1').rows[id].cells[4].children[8].value = "";
            //document.getElementById('table1').rows[id].cells[4].children[9].value = "";
            //event.preventDefault();

            var oTable = document.getElementById("table1");
            var rowLength = oTable.rows.length;           //gets rows of table
            var oCells = oTable.rows.item(id).cells;           

            oCells.item(4).children[0].children[0].children[1].value = "";
            oCells.item(4).children[0].children[0].children[3].value = "";
            oCells.item(4).children[0].children[0].children[8].value = "";
            oCells.item(4).children[0].children[0].children[9].value = "";

            event.preventDefault();
        }
        function showreqdate(name) {

            //20220530 nan edited start
            var oTable = document.getElementById("table1");
            var rowLength = oTable.rows.length;           //gets rows of table
            var oCells = oTable.rows.item(name).cells;
            var cell1Val = oCells.item(4).innerHTML; //data are set in column number 4                
            var celcount = oCells.item(4).children.length;
           //20220530 nan edited end

            //var result = document.getElementById('table1').rows[name].cells[4].children[5].checked;
            var result = oCells.item(4).children[0].children[0].children[5].checked;
            if (result == true) {
                event.preventDefault();

                var syear = document.getElementById('selectyear').value;
                var start_month = document.getElementById('txt_kisyu').value;
                var start_year = new Date(syear + "/" + start_month + "/01");

                var end_date = new Date(start_year.setMonth(start_year.getMonth() + 11));
                var end_month = end_date.getMonth() + 1;
                var emonth;
                var smonth;
                if (end_month < 10) {
                    emonth = "/0" + end_month;
                }
                else {
                    emonth = "/" + end_month;
                }

                if (start_month < 10) {
                    smonth = "/0" + start_month;
                }
                else {
                    smonth = "/" + start_month;
                }

                //document.getElementById('table1').rows[name].cells[4].children[1].value = syear + smonth;
                //document.getElementById('table1').rows[name].cells[4].children[8].value = syear + smonth;
                //$(document.getElementById('table1').rows[name].cells[4].children[1]).css('borderColor', '');
                //document.getElementById('table1').rows[name].cells[4].children[3].value = end_date.getFullYear() + emonth;
                //document.getElementById('table1').rows[name].cells[4].children[9].value = end_date.getFullYear() + emonth;
                ////document.getElementById('table1').rows[name].cells[4].children[9].value = eyear + "/" + emonth;
                //$(document.getElementById('table1').rows[name].cells[4].children[3]).css('borderColor', '');
                oCells.item(4).children[0].children[0].children[1].value = syear + smonth;
                oCells.item(4).children[0].children[0].children[8].value = syear + smonth;
                $(oCells.item(4).children[0].children[0].children[1]).css('borderColor', '');

                oCells.item(4).children[0].children[0].children[3].value = end_date.getFullYear() + emonth;
                oCells.item(4).children[0].children[0].children[9].value = end_date.getFullYear() + emonth;

                $(oCells.item(4).children[0].children[0].children[3]).css('borderColor', '');

                event.preventDefault();
            }

            event.preventDefault();
        }

        function OnChangesdate(id) {
            var oTable = document.getElementById("table1");
            var rowLength = oTable.rows.length;           //gets rows of table
            var oCells = oTable.rows.item(id).cells;
            var cell1Val = oCells.item(4).innerHTML; //data are set in column number 4                
            var celcount = oCells.item(4).children.length;

            if (celcount == 1) {

                //完了日が開始日より大きくかとか確認ため
                var curval = oCells.item(4).children[0].children[0].children[8].value;
                var curdate = "";
                if (curval != "") {
                    curdate = new Date(curval + "/01");
                }

                //開始期間（選択中）
                var startVal = oCells.item(4).children[0].children[0].children[1].value;
                var selecteddate = "";
                var selecteddate1 = "";
                if (startVal != "") {
                    selecteddate = new Date(startVal + "/01");
                    selecteddate1 = oCells.item(4).children[0].children[0].children[1].value;
                }

                //完了期間
                var endVal = oCells.item(4).children[0].children[0].children[3].value;
                var enddate = "";
                var enddate1 = "";
                if (endVal != "") {
                    enddate = new Date(endVal + "/01")
                    enddate1 = oCells.item(4).children[0].children[0].children[3].value;
                }

                //期間チェック
                if (selecteddate1.length > 0) {

                    if (enddate1.length > 0) {
                        if (selecteddate <= enddate) {
                            oCells.item(4).children[0].children[0].children[8].value = oCells.item(4).children[0].children[0].children[1].value;

                        }
                        else {
                            alert("実施開始日を正しい日付に修正して下さい。");
                            var mm = curdate.getMonth() + 1;

                            //var date1 = curdate.getFullYear() + "/" + mm;
                            //alert(date1)
                            var date1 = "";

                            if (mm < 10) {
                                date1 = curdate.getFullYear() + "/0" + mm;
                            }
                            else {
                                date1 = curdate.getFullYear() + "/" + mm;
                            }
                            // alert(date1)                         
                            oCells.item(4).children[0].children[0].children[1].value = date1;
                        }
                    }
                    else {

                        oCells.item(4).children[0].children[0].children[8].value = oCells.item(4).children[0].children[0].children[1].value;
                    }

                }
                else {
                    oCells.item(4).children[0].children[0].children[8].value = "";
                    oCells.item(4).children[0].children[0].children[1].value = "";
                }
            }
           /* //20220530　edited ナン
            // var selecteddate = document.getElementById('table1').rows[id].cells[4].children[1].value;
            var curdate = new Date(document.getElementById('table1').rows[id].cells[4].children[8].value + "/01");

            //var date1 = document.getElementById('table1').rows[id].cells[4].children[8].value;

            var selecteddate = new Date(document.getElementById('table1').rows[id].cells[4].children[1].value + "/01");
            var selecteddate1 = document.getElementById('table1').rows[id].cells[4].children[1].value;

            var enddate = new Date(document.getElementById('table1').rows[id].cells[4].children[3].value + "/01")
            var enddate1 = document.getElementById('table1').rows[id].cells[4].children[3].value;


            if (selecteddate1.length > 0) {

                if (enddate1.length > 0) {
                    if (selecteddate <= enddate) {
                        document.getElementById('table1').rows[id].cells[4].children[8].value = document.getElementById('table1').rows[id].cells[4].children[1].value;

                    }
                    else {
                        alert("実施開始日を正しい日付に修正して下さい。");
                        var mm = curdate.getMonth() + 1;

                        //var date1 = curdate.getFullYear() + "/" + mm;
                        //alert(date1)
                        var date1 = "";

                        if (mm < 10) {
                            date1 = curdate.getFullYear() + "/0" + mm;
                        }
                        else {
                            date1 = curdate.getFullYear() + "/" + mm;
                        }
                        // alert(date1)
                        document.getElementById('table1').rows[id].cells[4].children[1].value = date1;
                    }
                }
                else {

                    document.getElementById('table1').rows[id].cells[4].children[8].value = document.getElementById('table1').rows[id].cells[4].children[1].value;
                }

            }
            else {

                document.getElementById('table1').rows[id].cells[4].children[8].value = "";
                document.getElementById('table1').rows[id].cells[4].children[1].value = "";
            }
            */

        }
        function OnChangeedate(id) {

            var oTable = document.getElementById("table1");
            var rowLength = oTable.rows.length;           //gets rows of table
            var oCells = oTable.rows.item(id).cells;
            var cell1Val = oCells.item(4).innerHTML; //data are set in column number 4                
            var celcount = oCells.item(4).children.length;

            if (celcount == 1) {
                //完了日が開始日より大きくかとか確認ため
                var curval = oCells.item(4).children[0].children[0].children[9].value;
                var curdate = "";
                if (curval != "") {
                    curdate = new Date(curval + "/01");
                }

                //完了期間（選択中）
                var selectedVal = oCells.item(4).children[0].children[0].children[3].value;
                var selecteddate = "";
                var selecteddate1 = "";
                if (selectedVal != "") {
                    selecteddate = new Date(selectedVal + "/01");
                    selecteddate1 = oCells.item(4).children[0].children[0].children[3].value;
                }

                //開始期間  
                var startdateVal = oCells.item(4).children[0].children[0].children[1].value;
                var startdate = "";
                var startdate1 = "";
                if (startdateVal != "") {
                    startdate = new Date(startdateVal + "/01")
                    startdate1 = oCells.item(4).children[0].children[0].children[1].value;
                }
                //alert('selecteddate1.length<<' + selecteddate1.length + '<<startdate1.length<<' + startdate1.length);
                if (selecteddate1.length > 0) {
                    if (startdate1.length > 0) {
                        if (selecteddate >= startdate) {
                            //alert(oCells.item(4).children[0].children[0].children[3].value);
                            oCells.item(4).children[0].children[0].children[9].value = oCells.item(4).children[0].children[0].children[3].value;
                            //alert(oCells.item(4).children[0].children[0].children[9].value);
                        }
                        else {
                            alert("実施完了日には開始日以降の日付を指定して下さい。");
                            var mm = curdate.getMonth() + 1;
                            var date1 = "";

                            if (mm < 10) {
                                date1 = curdate.getFullYear() + "/0" + mm;
                            }
                            else {
                                date1 = curdate.getFullYear() + "/" + mm;
                            }
                            oCells.item(4).children[0].children[0].children[3].value = date1;
                        }
                    }
                    else {
                        //alert(oCells.item(4).children[0].children[0].children[3].value);
                        oCells.item(4).children[0].children[0].children[9].value = oCells.item(4).children[0].children[0].children[3].value;
                        //alert(oCells.item(4).children[0].children[0].children[9].value);
                    }
                }
                else {

                    oCells.item(4).children[0].children[0].children[9].value = "";
                    oCells.item(4).children[0].children[0].children[3].value = "";
                }
            }
            //20220530　edited ナン
            /*var curdate = new Date(document.getElementById('table1').rows[id].cells[4].children[9].value + "/01");

            var selecteddate = new Date(document.getElementById('table1').rows[id].cells[4].children[3].value + "/01");
            var selecteddate1 = document.getElementById('table1').rows[id].cells[4].children[3].value;

            var startdate = new Date(document.getElementById('table1').rows[id].cells[4].children[1].value + "/01")
            var startdate1 = document.getElementById('table1').rows[id].cells[4].children[1].value;

            if (selecteddate1.length > 0) {
                if (startdate1.length > 0) {

                    if (selecteddate >= startdate) {

                        document.getElementById('table1').rows[id].cells[4].children[9].value = document.getElementById('table1').rows[id].cells[4].children[3].value;

                    }
                    else {
                        alert("実施完了日には開始日以降の日付を指定して下さい。");
                        var mm = curdate.getMonth() + 1;
                        var date1 = "";

                        if (mm < 10) {
                            date1 = curdate.getFullYear() + "/0" + mm;
                        }
                        else {
                            date1 = curdate.getFullYear() + "/" + mm;
                        }
                        document.getElementById('table1').rows[id].cells[4].children[3].value = date1;
                    }
                }
                else {
                    document.getElementById('table1').rows[id].cells[4].children[9].value = document.getElementById('table1').rows[id].cells[4].children[3].value;
                }
            }
            else {

                document.getElementById('table1').rows[id].cells[4].children[9].value = "";
                document.getElementById('table1').rows[id].cells[4].children[3].value = "";
            }*/
        }
    </script>
    <script>
        $(function () {
            $('#check').click(function () {
                $('#btnchecksearch').click();
            });
        });

        function isSpecialKey(evt) {
            var regex = new RegExp("^[0-9]+$");
            var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);

            if (!regex.test(key)) {

                event.preventDefault();
                return false;
            }

        }
        function savemsgshow() {
            alert("社員名を選択してください。")
            event.preventDefault();
        }
        function fsavemsgshow() {
            alert("社員名を選択してください。")
            event.preventDefault();
        }

    </script>
    <script>


    </script>
    <script>
        function roundDown(number, decimals) {
            decimals = decimals || 0;
            return (Math.floor(number * Math.pow(10, decimals)) / Math.pow(10, decimals));
        }
        function edValueKeyPress(id) {
            //  alert(id)

            //20220530 nan modify
            var oTable = document.getElementById("table1");
            var rowLength = oTable.rows.length;           //gets rows of table
            var oCells = oTable.rows.item(id).cells;


            oCells.item(4).children[0].children[1].children[1].value = oCells.item(4).children[0].children[1].children[1].value.substring(0, 3);
            oCells.item(4).children[0].children[1].children[3].value = oCells.item(4).children[0].children[1].children[3].value.substring(0, 3);
            if (isNaN(oCells.item(4).children[0].children[1].children[1].value)) {
                oCells.item(4).children[0].children[1].children[1].value = ""; //配点
                oCells.item(4).children[0].children[1].children[5].value = "";　//点数
                return false;
            }

            if (oCells.item(4).children[0].children[1].children[1].value == "0") {
                oCells.item(4).children[0].children[1].children[1].value = "1";
            }
            var upper = document.getElementById('upper').value;
            var lower = document.getElementById('lower').value;
            var i = id;
            var totaltensu = 0.00;

            var haitem = oCells.item(4).children[0].children[1].children[1].value;
            var percent = oCells.item(4).children[0].children[1].children[3].value;

            percent = percent.replace("%", "");

            if (isNaN(percent)) {
                oCells.item(4).children[0].children[1].children[3].value = "";
                oCells.item(4).children[0].children[1].children[5].value = "";
                return false;
            }

            if (haitem.trim().length > 0 && percent.trim().length > 0 && upper.trim().length > 0 && lower.trim().length > 0) {

                if (percent > 100) {
                    percent = 100;
                }                
                totaltensu = haitem * (percent - lower) / (upper - lower);
                oCells.item(4).children[0].children[1].children[3].value = percent + "%";
                oCells.item(4).children[0].children[1].children[5].value = roundDown(totaltensu, 2).toFixed(2);

            }
            else {

                if (percent > 100) {
                    percent = "100";
                }
                oCells.item(4).children[0].children[1].children[5].value = "";
                if (percent.trim().length == 0) {
                    oCells.item(4).children[0].children[1].children[3].value = "";
                }
                if (percent.trim().length > 0) {
                    oCells.item(4).children[0].children[1].children[3].value = percent + "%";

                }
            }
            if (haitem.trim().length > 0) {
                $(oCells.item(4).children[0].children[1].children[1]).css('borderColor', '');
            }
            if (percent.trim().length > 0) {
                $(oCells.item(4).children[0].children[1].children[3]).css('borderColor', '');
            }


            //20220530 nan modify
            /*document.getElementById('table1').rows[id].cells[5].children[1].value = document.getElementById('table1').rows[id].cells[5].children[1].value.substring(0, 3);
            document.getElementById('table1').rows[id].cells[5].children[3].value = document.getElementById('table1').rows[id].cells[5].children[3].value.substring(0, 4);
            if (isNaN(document.getElementById('table1').rows[id].cells[5].children[1].value)) {
                document.getElementById('table1').rows[id].cells[5].children[1].value = "";
                document.getElementById('table1').rows[i].cells[5].children[5].value = "";
                return false;
            }
            if (document.getElementById('table1').rows[id].cells[5].children[1].value == "0") {
                document.getElementById('table1').rows[id].cells[5].children[1].value = "1";
            }


            var i = id;
            var upper = document.getElementById('upper').value;
            var lower = document.getElementById('lower').value;
            //alert(upper);
            //alert(lower);
            //var n1 = document.getElementById("table1").rows.length;
            var totaltensu=0.00 ;
            //for (var i = 1; i < n1; i++) {
            var haitem = document.getElementById('table1').rows[i].cells[5].children[1].value;
            var percent = document.getElementById('table1').rows[i].cells[5].children[3].value;
            percent = percent.replace("%", "");
            if(isNaN(percent)) {
                document.getElementById('table1').rows[id].cells[5].children[3].value = "";
                document.getElementById('table1').rows[i].cells[5].children[5].value = "";
                return false;
            }

            if (haitem.trim().length > 0 && percent.trim().length > 0 && upper.trim().length > 0 && lower.trim().length > 0) {

                if (percent > 100) {
                    percent = 100;
                }
                //totaltensu = haitem * percent;
                //totaltensu = totaltensu / 100;
                totaltensu = haitem * (percent - lower) / (upper - lower);
                document.getElementById('table1').rows[i].cells[5].children[3].value = percent + "%";


                // document.getElementById('table1').rows[i].cells[5].children[5].value = parseFloat(totaltensu).toFixed(2);
                document.getElementById('table1').rows[i].cells[5].children[5].value = roundDown(totaltensu,2).toFixed(2);

            }
            else {

                if (percent > 100) {
                    percent = "100";
                }
                document.getElementById('table1').rows[i].cells[5].children[5].value = "";
                if (percent.trim().length == 0) {
                    document.getElementById('table1').rows[i].cells[5].children[3].value = "";
                }
                if (percent.trim().length > 0) {
                    document.getElementById('table1').rows[i].cells[5].children[3].value = percent + "%";

                }
            }
            if (haitem.trim().length > 0) {
                $(document.getElementById('table1').rows[id].cells[5].children[1]).css('borderColor', '');
            }
            if (percent.trim().length > 0) {
                $(document.getElementById('table1').rows[id].cells[5].children[3]).css('borderColor', '');
            }*/
        }

        $('#addrow').click(function (event) {

            var oTable = document.getElementById("table1");
          
           

            var tabel = document.getElementsByTagName("table")[0];
            var rows = document.getElementsByTagName("table")[0].rows.length - 1;
            var rows = tabel.rows.length - 1;
            var notallow;
            var j = 0;
            var n1 = document.getElementById("table1").rows.length;
            if (n1 <= 16) {
            }
            else {
                alert("最大追加できるのは16テーマまでです。");
                event.preventDefault();
                for (var i = 1; i < n1; i++) {
                    var oCells = oTable.rows.item(i).cells; //20220530 added nan 
                    //$(document.getElementById('table1').rows[i].cells[4].children[0]).css('borderColor', '');
                    //$(oCells.item(4).children[0].children[0].children[0].value).css('borderColor', '');
                }

            }

        });
        $('#save').click(function (event) {
            var oTable = document.getElementById("table1");
            var n1 = document.getElementById("table1").rows.length;
            var totaltensu1 = 0.00;
            var totaltensu = 0;
            var comparehaiten = document.getElementById('txt_haitem').value;

            for (var i = 1; i < n1; i++) {
                //var haitem = document.getElementById('table1').rows[i].cells[5].children[1].value; //20220530 nan deleted
                var haitem = oCells.item(4).children[0].children[1].children[1].value; //20220530 nan added
                if (haitem.trim().length > 0) {
                    totaltensu += parseInt(haitem);
                }
            }

            var msg = document.getElementById('txt_msg').value;

            var n1 = document.getElementById("table1").rows.length;
            var notallow;
            var j = 0;
            var check = 0;
            for (var i = 1; i < n1; i++) {

                //var sdate = document.getElementById('table1').rows[i].cells[4].children[1].value;
                //var edate = document.getElementById('table1').rows[i].cells[4].children[3].value;
                //var x = document.getElementById('table1').rows[i].cells[4].children[7].value;
                //var haitem = document.getElementById('table1').rows[i].cells[5].children[1].value;
                //var percent = document.getElementById('table1').rows[i].cells[5].children[3].value;
                //var x2 = document.getElementById('table1').rows[i].cells[5].children[6].value;
                //var btnvalue = document.getElementById('table1').rows[i].cells[7].children[0].value;
                var oCells = oTable.rows.item(i).cells;
                var sdate = oCells.item(4).children[0].children[0].children[1].value; //開始期間 20220530　ナン edited
                var edate = oCells.item(4).children[0].children[0].children[3].value; //完了期間 20220530　ナン edited
                var x = oCells.item(4).children[0].children[0].children[7].value;     //タスク内容 20220530　ナン edited

                var haitem = oCells.item(4).children[0].children[1].children[1].value; //配点数 20220530　ナン edited
                var percent = oCells.item(4).children[0].children[1].children[3].value;//達成率数 20220530　ナン edited
                var x2 = oCells.item(4).children[0].children[1].children[6].value;　   //実地結果 20220530　ナン edited
                var btnvalue = oCells.item(4).children[0].children[2].children[0].value

                if (btnvalue == "済") {
                    var checkvalue = 0;
                    j++;
                    if (@Model.rdo_komoku== "1") {
                        if (sdate.trim().length == 0 && edate.trim().length == 0 && x.trim().length == 0 && haitem.trim().length == 0 && percent.trim().length == 0 && x2.trim().length == 0) {
                            notallow = "no";
                            break;
                        }
                        if (haitem.trim().length == 0) {
                            checkvalue++;
                        }
                        if (x.trim().length == 0) {
                            checkvalue++;
                        }

                        if (checkvalue >= 1) {
                            notallow = "no";
                            break;
                        }
                        else {
                            if (x.trim().length > 0 && haitem.trim().length > 0 && percent.trim().length > 0) {
                                notallow = "yes";
                                j = j - 1;
                            }
                            else if (x.trim().length > 0 && haitem.trim().length > 0 && percent.trim().length == 0) {
                                notallow = "percent0";
                                check++;
                            }

                        }

                    }
                    else {
                        if (sdate.trim().length == 0 && edate.trim().length == 0 && x.trim().length == 0 &&  percent.trim().length == 0){
                            notallow = "no";
                            break;
                        }
                        if (x.trim().length == 0) {
                            checkvalue++;
                        }
                        if (checkvalue >= 1) {
                            notallow = "no";
                            break;
                        }
                        else {
                            if (x.trim().length > 0 &&  percent.trim().length > 0) {
                                notallow = "yes";
                                j = j - 1;
                            }
                            else if (x.trim().length > 0 && percent.trim().length == 0) {
                                notallow = "percent0";
                                check++;
                            }

                        }
                    }

                }
                else {
                    notallow = "yes";

                }

            }

            if (check > 0) {
                if (j == check) {
                    notallow = "percent0";
                }
            }
            if (notallow == "percent0") {

                    if (@Model.rdo_komoku== "1") {
                        if (totaltensu <= comparehaiten) {
                            if (confirm("達成率が(「０」or 「」)になっても、保存してよろしいでしょうか？")) {

                            }
                            else {
                                event.preventDefault();
                                for (var i = 1; i < n1; i++) {
                                    //var sdate = document.getElementById('table1').rows[i].cells[4].children[1].value;
                                    //var edate = document.getElementById('table1').rows[i].cells[4].children[3].value;
                                    //var x = document.getElementById('table1').rows[i].cells[4].children[7].value;
                                    //var haitem = document.getElementById('table1').rows[i].cells[5].children[1].value;
                                    //var percent = document.getElementById('table1').rows[i].cells[5].children[3].value;
                                    //var x2 = document.getElementById('table1').rows[i].cells[5].children[6].value;
                                    //var btnvalue = document.getElementById('table1').rows[i].cells[7].children[0].value;

                                    var oCells = oTable.rows.item(i).cells;
                                    var sdate = oCells.item(4).children[0].children[0].children[1].value; //開始期間 20220530　ナン edited
                                    var edate = oCells.item(4).children[0].children[0].children[3].value; //完了期間 20220530　ナン edited
                                    var x = oCells.item(4).children[0].children[0].children[7].value;     //タスク内容 20220530　ナン edited

                                    var haitem = oCells.item(4).children[0].children[1].children[1].value; //配点数 20220530　ナン edited
                                    var percent = oCells.item(4).children[0].children[1].children[3].value;//達成率数 20220530　ナン edited
                                    var x2 = oCells.item(4).children[0].children[1].children[6].value;　   //実地結果 20220530　ナン edited
                                    var btnvalue = oCells.item(4).children[0].children[2].children[0].value;

                                    //  alert(btnvalue)
                                    if (btnvalue == "済") {
                                        if (percent.trim().length == 0) {
                                            //$(document.getElementById('table1').rows[i].cells[5].children[3]).css('borderColor', '#f3172d');
                                            $(oCells.item(4).children[0].children[1].children[3].value).css('borderColor', '#f3172d');
                                        }
                                        if (percent == "0") {
                                            //$(document.getElementById('table1').rows[i].cells[5].children[3]).css('borderColor', '#f3172d');
                                            $(oCells.item(4).children[0].children[1].children[3].value).css('borderColor', '#f3172d');
                                        }
                                    }
                                    else {
                                        //$(document.getElementById('table1').rows[i].cells[4].children[1]).css('borderColor', ''); //20220530 nan deleted
                                        //$(document.getElementById('table1').rows[i].cells[4].children[3]).css('borderColor', '');
                                        //$(document.getElementById('table1').rows[i].cells[4].children[7]).css('borderColor', '');
                                        //$(document.getElementById('table1').rows[i].cells[5].children[1]).css('borderColor', '');
                                        //$(document.getElementById('table1').rows[i].cells[5].children[3]).css('borderColor', '');
                                        //$(document.getElementById('table1').rows[i].cells[5].children[6]).css('borderColor', '');

                                         
                                        $(oCells.item(4).children[0].children[0].children[1].value).css('borderColor', ''); //20220530 nan added
                                        $(oCells.item(4).children[0].children[0].children[3].value).css('borderColor', ''); //20220530 nan added
                                        $(oCells.item(4).children[0].children[0].children[7].value).css('borderColor', ''); //20220530 nan added
                                        $(oCells.item(4).children[0].children[1].children[1].value).css('borderColor', ''); //20220530 nan added
                                        $(oCells.item(4).children[0].children[1].children[3].value).css('borderColor', ''); //20220530 nan added
                                        $(oCells.item(4).children[0].children[1].children[6].value).css('borderColor', ''); //20220530 nan added
                                    }
                                }
                            }
                        }
                        else {
                            alert("テーマ配点「" + comparehaiten + "」をオーバーしています。調整してください。")
                            event.preventDefault();
                            for (var i = 1; i < n1; i++) {
                                var oCells = oTable.rows.item(i).cells;
                                //$(document.getElementById('table1').rows[i].cells[4].children[1]).css('borderColor', ''); //20220530 nan deleted
                                //$(document.getElementById('table1').rows[i].cells[4].children[3]).css('borderColor', '');
                                //$(document.getElementById('table1').rows[i].cells[4].children[7]).css('borderColor', '');
                                //$(document.getElementById('table1').rows[i].cells[5].children[1]).css('borderColor', '');
                                //$(document.getElementById('table1').rows[i].cells[5].children[3]).css('borderColor', '');
                                //$(document.getElementById('table1').rows[i].cells[5].children[6]).css('borderColor', '');

                                $(oCells.item(4).children[0].children[0].children[1].value).css('borderColor', ''); //20220530 nan added
                                $(oCells.item(4).children[0].children[0].children[3].value).css('borderColor', ''); //20220530 nan added
                                $(oCells.item(4).children[0].children[0].children[7].value).css('borderColor', ''); //20220530 nan added
                                $(oCells.item(4).children[0].children[1].children[1].value).css('borderColor', ''); //20220530 nan added
                                $(oCells.item(4).children[0].children[1].children[3].value).css('borderColor', ''); //20220530 nan added
                                $(oCells.item(4).children[0].children[1].children[6].value).css('borderColor', ''); //20220530 nan added

                            }
                        }
                    }
                    else {
                        if (confirm("達成率が(「０」or 「」)になっても、保存してよろしいでしょうか？")) {

                        }
                        else {
                            event.preventDefault();
                            for (var i = 1; i < n1; i++) {
                                //var percent = document.getElementById('table1').rows[i].cells[5].children[3].value; //20220530 nan deleted

                                //var btnvalue = document.getElementById('table1').rows[i].cells[7].children[0].value; //20220530 nan deleted

                                var percent = oCells.item(4).children[0].children[1].children[3].value; //20220530 nan added
                                var btnvalue = oCells.item(4).children[0].children[2].children[0].value; //20220530 nan added

                                //  alert(btnvalue)
                                if (btnvalue == "済") {
                                    if (percent.trim().length == 0) {
                                        //$(document.getElementById('table1').rows[i].cells[5].children[3]).css('borderColor', '#f3172d'); //20220530 nan deleted
                                        $(oCells.item(4).children[0].children[1].children[3].value).css('borderColor', '#f3172d');//20220530 nan added
                                    }

                                    if (percent == "0") {
                                        //$(document.getElementById('table1').rows[i].cells[5].children[3]).css('borderColor', '#f3172d'); //20220530 nan deleted
                                        $(oCells.item(4).children[0].children[1].children[3].value).css('borderColor', '#f3172d');//20220530 nan added
                                    }
                                }
                                else {
                                    //$(document.getElementById('table1').rows[i].cells[4].children[1]).css('borderColor', ''); //20220530 nan deleted
                                    //$(document.getElementById('table1').rows[i].cells[4].children[3]).css('borderColor', '');
                                    //$(document.getElementById('table1').rows[i].cells[4].children[7]).css('borderColor', '');
                                    //$(document.getElementById('table1').rows[i].cells[5].children[1]).css('borderColor', '');
                                    //$(document.getElementById('table1').rows[i].cells[5].children[3]).css('borderColor', '');
                                    //$(document.getElementById('table1').rows[i].cells[5].children[6]).css('borderColor', '');

                                    $(oCells.item(4).children[0].children[0].children[1].value).css('borderColor', ''); //20220530 nan added
                                    $(oCells.item(4).children[0].children[0].children[3].value).css('borderColor', ''); //20220530 nan added
                                    $(oCells.item(4).children[0].children[0].children[7].value).css('borderColor', ''); //20220530 nan added
                                    $(oCells.item(4).children[0].children[1].children[1].value).css('borderColor', ''); //20220530 nan added
                                    $(oCells.item(4).children[0].children[1].children[3].value).css('borderColor', ''); //20220530 nan added
                                    $(oCells.item(4).children[0].children[1].children[6].value).css('borderColor', ''); //20220530 nan added
                                }
                            }
                        }

                    }

            }
            else if (notallow == "no"){
                event.preventDefault();
                for (var i = 1; i < n1; i++) {
                    //var sdate = document.getElementById('table1').rows[i].cells[4].children[1].value;
                    //var edate = document.getElementById('table1').rows[i].cells[4].children[3].value;
                    //var x = document.getElementById('table1').rows[i].cells[4].children[7].value;
                    //var haitem = document.getElementById('table1').rows[i].cells[5].children[1].value;
                    //var percent = document.getElementById('table1').rows[i].cells[5].children[3].value;
                    //var x2 = document.getElementById('table1').rows[i].cells[5].children[6].value;
                    //var btnvalue = document.getElementById('table1').rows[i].cells[7].children[0].value;

                    var oCells = oTable.rows.item(i).cells;
                    var sdate = oCells.item(4).children[0].children[0].children[1].value; //開始期間 20220530　nan edited
                    var x = oCells.item(4).children[0].children[0].children[7].value;     //タスク内容 20220530　nan edited

                    var haitem = oCells.item(4).children[0].children[1].children[1].value; //配点数 20220530　nan edited
                    var percent = oCells.item(4).children[0].children[1].children[3].value;//達成率数 20220530　nan edited
                    var x2 = oCells.item(4).children[0].children[1].children[6].value;　   //実地結果 20220530　nan edited
                    var btnvalue = oCells.item(4).children[0].children[2].children[0].value;

                    if (btnvalue == "済") {
                        if (@Model.rdo_komoku== "1") {
                            if (x.trim().length == 0) {
                                //$(document.getElementById('table1').rows[i].cells[4].children[7]).css('borderColor', '#f3172d'); //20220530 nan deleted
                                $(oCells.item(4).children[0].children[0].children[7].value).css('borderColor', '#f3172d'); //20220530 nan added
                            }
                            if (haitem.trim().length == 0) {
                                //$(document.getElementById('table1').rows[i].cells[5].children[1]).css('borderColor', '#f3172d'); //20220530 nan deleted
                                $(oCells.item(4).children[0].children[1].children[1].value).css('borderColor', '#f3172d');//20220530 nan added
                            }
                        }
                        else {
                            if (x.trim().length == 0) {
                                //$(document.getElementById('table1').rows[i].cells[4].children[7]).css('borderColor', '#f3172d'); //20220530 nan deleted
                                $(oCells.item(4).children[0].children[0].children[7].value).css('borderColor', '#f3172d');//20220530 nan added
                            }
                        }
                    }
                    else {
                        //$(document.getElementById('table1').rows[i].cells[4].children[1]).css('borderColor', '');//20220530 nan deleted
                        //$(document.getElementById('table1').rows[i].cells[4].children[3]).css('borderColor', '');
                        //$(document.getElementById('table1').rows[i].cells[4].children[7]).css('borderColor', '');
                        //$(document.getElementById('table1').rows[i].cells[5].children[1]).css('borderColor', '');
                        //$(document.getElementById('table1').rows[i].cells[5].children[3]).css('borderColor', '');
                        //$(document.getElementById('table1').rows[i].cells[5].children[6]).css('borderColor', '');

                        $(oCells.item(4).children[0].children[0].children[1].value).css('borderColor', ''); //20220530 nan added
                        $(oCells.item(4).children[0].children[0].children[3].value).css('borderColor', ''); //20220530 nan added
                        $(oCells.item(4).children[0].children[0].children[7].value).css('borderColor', ''); //20220530 nan added
                        $(oCells.item(4).children[0].children[1].children[1].value).css('borderColor', ''); //20220530 nan added
                        $(oCells.item(4).children[0].children[1].children[3].value).css('borderColor', ''); //20220530 nan added
                        $(oCells.item(4).children[0].children[1].children[6].value).css('borderColor', ''); //20220530 nan added
                    }
                }
            }
            else {
                var comparehaiten = document.getElementById('txt_haitem').value;
                var n1 = document.getElementById("table1").rows.length;

                    if (@Model.rdo_komoku== "1") {
                        if (totaltensu <= comparehaiten) {

                        }
                        else {
                            alert("テーマ配点「" + comparehaiten + "」をオーバーしています。調整してください。")
                            event.preventDefault();
                            for (var i = 1; i < n1; i++) {
                               
                                //$(document.getElementById('table1').rows[i].cells[4].children[1]).css('borderColor', ''); //20220530 nan deleted
                                //$(document.getElementById('table1').rows[i].cells[4].children[3]).css('borderColor', '');
                                //$(document.getElementById('table1').rows[i].cells[4].children[7]).css('borderColor', '');
                                //$(document.getElementById('table1').rows[i].cells[5].children[1]).css('borderColor', '');
                                //$(document.getElementById('table1').rows[i].cells[5].children[3]).css('borderColor', '');

                                var oCells = oTable.rows.item(i).cells;
                                $(oCells.item(4).children[0].children[0].children[1].value).css('borderColor', ''); //20220530 nan added
                                $(oCells.item(4).children[0].children[0].children[3].value).css('borderColor', ''); //20220530 nan added
                                $(oCells.item(4).children[0].children[0].children[7].value).css('borderColor', ''); //20220530 nan added
                                $(oCells.item(4).children[0].children[1].children[1].value).css('borderColor', ''); //20220530 nan added
                                $(oCells.item(4).children[0].children[1].children[3].value).css('borderColor', ''); //20220530 nan added                               
                            }

                        }
                    }
                    else {

                    }

            }
        });



        function OnChanged(evt) {

            $('#btnsearch').click();
        }
        function OnChangedshainlist(evt) {
            $('#btnshainsearch').click();
        }

        function OnChangeddate(evt) {

            $('#btntoday').click();
        }
    </script>
</body>
</html>
<script type="text/javascript" src=@Url.Content("~/Scripts/jquery-1.12.4.min.js")></script>
<script type="text/javascript" src=@Url.Content("~/Scripts/croppie.js")></script>
<script type="text/javascript" src=@Url.Content("~/Scripts/croppie.min.js")></script>
<link href="~/Content/croppie.css" rel="stylesheet" />
